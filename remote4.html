<!DOCTYPE html>
	<html>
		<head>
			<meta charset="UTF-8">
			<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
			<meta name="apple-mobile-web-app-capable" content="yes">
			
			<script>
			const p = "data:text/html;base64,PGJvZHk+PC9ib2R5Pg==";
			class LUMIX_CLIENT{
				static SHTR_SPEEDS_STR = ["T", "1/2000", "1/1600", "1/1300", "1/1000", "1/800", "1/640", "1/500", "1/400", "1/320", "1/250", "1/200", "1/160", "1/125", "1/100", "1/80", "1/60", "1/50", "1/40", "1/30", "1/25", "1/20", "1/15", "1/13", "1/10", "1/8", "1/6", "1/5", "1/4", "1/3.2", "1/2.5", "1/2", "1/1.6", "1/1.3", "1", "1.3", "1.6", "2", "2.5", "3.2", "4", "5", "6", "8", "10", "13", "15", "20", "25", "30", "40", "50", "60"];
				static SHTR_SPEEDS = [-1, 1/2000, 1/1600, 1/1300, 1/1000, 1/800, 1/640, 1/500, 1/400, 1/320, 1/250, 1/200, 1/160, 1/125, 1/100, 1/80, 1/60, 1/50, 1/40, 1/30, 1/25, 1/20, 1/15, 1/13, 1/10, 1/8, 1/6, 1/5, 1/4, 1/3.2, 1/2.5, 1/2, 1/1.6, 1/1.3, 1, 1.3, 1.6, 2, 2.5, 3.2, 4, 5, 6, 8, 10, 13, 15, 20, 25, 30, 40, 50, 60];
				static APERTURES = [2.8, 3.2, 3.5, 4, 4.5, 5, 5.6, 6.3, 7.1, 8];
				static ISOS = [80, 100, 125, 200, 400, 800, 1600, 3200, 6400, 12800, 25600];

				// Dessa är färdiga (dvs. uppgraderade för att använda WebSockets).
				constructor(){
					/**
					 * Timelapse state.
					 */
					this.timelapse = {
						total: 0,
						interval: 0,
						remaining: 0
					};

					/**
					 * Current settings on the camera.
					 */
					this.camera_settings = {
						iso_id: 0,
						aperture_id: 0,
						shtr_id: 0,
						wb: 4000
					};

					/**
					 * Additional settings.
					 */
					this.state = {
						timed_shutter: 0,
						photo_mode: 0
					};

					/**
					 * Settings for "off-camera" (server) autoexposure.
					 */
					this.oc_auto_exp = {
						enabled: false,
						order_id: 0b001,
						iso_limit: [0, 6],
						shtr_limit: [1, 51],
						aperture_limit: [0, 9]
					};

					this.websocket;
					this.el = {
						sl_sv: document.getElementById("sl_sv"),
						shutterSpeedInput: document.getElementById("sl_s"),
						isoInput: document.getElementById("sl_i"),
						isoText: document.getElementById("sl_iv"),
						apertureText: document.getElementById("sl_av"),
						apertureInput: document.getElementById("sl_a"),
						wbInput: document.getElementById("sl_w"),
						wbText: document.getElementById("sl_wv"),
						spt: document.getElementById("spt"),
						tlt: document.getElementById("tlt"),
						brt: document.getElementById("brt"),
						brc: document.getElementById("brc"),
						tlc: document.getElementById("tlc"),
						spc: document.getElementById("spc"),
						shutterReleaseBtn: document.getElementById("sbtn"),
						startTimelapseBtn: document.getElementById("ti"),
						sl_it: document.getElementById("sl_it"),
						sl_im: document.getElementById("sl_im"),
						tlr: document.getElementById("tlr"),
						pr: document.getElementById("pr"),
						tr: document.getElementById("tr"),
						sl_itv: document.getElementById("sl_itv"),
						sl_imv: document.getElementById("sl_imv"),
						tsh: document.getElementById("tsh"),
						pci: document.getElementById("pci"),
						saeb: document.getElementById("saeb"),
						saed: document.getElementById("saed"),
						aec: document.getElementById("aec"),
						sae_in_sel: document.getElementById("sae_in_sel"),
						sae_ix_sel: document.getElementById("sae_ix_sel"),
						sae_sn_sel: document.getElementById("sae_sn_sel"),
						sae_sx_sel: document.getElementById("sae_sx_sel"),
						sae_an_sel: document.getElementById("sae_an_sel"),
						sae_ax_sel: document.getElementById("sae_ax_sel"),
						sae_o_sel: document.getElementById("sae_o_sel"),
						lpu: document.getElementById("lpu"),
						lpset: document.getElementById("lpset")
					};

					this.sae_visible = false;

					let socket=new WebSocket('ws://ipa.ddr.ish.ere:8081');
					socket.addEventListener('open', event => {
						socket.send(new Uint8Array([0b0])); // klient redo
						this.websocket=socket;
						// Shutter input/change
						this.el.shutterSpeedInput.addEventListener("input", () => this.setShutter(-1, false));
						this.el.shutterSpeedInput.addEventListener("change", () => this.setShutter(-1, true));
						
						// Aperture input/change
						this.el.apertureInput.addEventListener("input", () => this.setAperture(parseInt(this.el.apertureInput.value), false));
						this.el.apertureInput.addEventListener("change", () => this.setAperture(parseInt(this.el.apertureInput.value), true));
						
						// ISO input/change
						this.el.isoInput.addEventListener("input", () => this.setISO(parseInt(this.el.isoInput.value), false));
						this.el.isoInput.addEventListener("change", () => this.setISO(parseInt(this.el.isoInput.value), true));
						
						// WB input/change
						this.el.wbInput.addEventListener("input", () => this.setWB(parseInt(this.el.wbInput.value), false));
						this.el.wbInput.addEventListener("change", () => this.setWB(parseInt(this.el.wbInput.value), true));
						
						// Välj läge (foto, timelapse, burst)
						this.el.spt.addEventListener("click", () => this.setPhotoMode(0, true));
						this.el.tlt.addEventListener("click", () => this.setPhotoMode(1, true));
						this.el.brt.addEventListener("click", () => this.setPhotoMode(2, true));
						
						// Ta ett foto (foto-läge)
						this.el.shutterReleaseBtn.addEventListener("click", () => this.takePhoto());
						
						// Starta timelapse
						this.el.startTimelapseBtn.addEventListener("click", () => {
							if(this.timelapse.remaining > 0){
								this.websocket.send(new Uint8Array([0b1001, 0, 0, 0])); // stoppa timelapse
							} else {
								let interval = parseInt(this.el.sl_it.value);
								let pic_count = parseInt(this.el.sl_im.value);
								this.websocket.send(new Uint8Array([0b1001, interval, pic_count >>> 8, pic_count]));
								this.el.startTimelapseBtn.innerText="STOP";
								this.el.sl_it.setAttribute("disabled","");
								this.el.sl_im.setAttribute("disabled","");
								this.el.tsh.setAttribute("disabled","");
							}
						});
						
						// Timelapse-inställningar
						this.el.sl_it.addEventListener("input",()=>this.el.sl_itv.innerText=this.el.sl_it.value+" s");
						
						this.el.sl_im.addEventListener("input",()=>this.el.sl_imv.innerText=this.el.sl_im.value+" st");
						
						// Vanlig eller "timed" (från servern) shutter
						this.el.tsh.addEventListener("change", () => {
							this.setTimedShutter(this.el.tsh.checked ? 5 : 0, true);
						});
						
						// Visa inställningar för auto-exp (server)
						this.el.saeb.addEventListener("click", () => {
							if(this.sae_visible){
								this.el.saed.style.display = "none";
								this.sae_visible = false;
							} else {
								this.el.saed.style.display = "block";
								this.sae_visible = true;
								this.el.sae_ix_sel.value = this.oc_auto_exp.iso_limit[1].toString(10);
								this.el.sae_in_sel.value = this.oc_auto_exp.iso_limit[0].toString(10);
								this.el.sae_ax_sel.value = this.oc_auto_exp.aperture_limit[1].toString(10);
								this.el.sae_an_sel.value = this.oc_auto_exp.aperture_limit[0].toString(10);
								this.el.sae_sx_sel.value = this.oc_auto_exp.shtr_limit[1].toString(10);
								this.el.sae_sn_sel.value = this.oc_auto_exp.shtr_limit[0].toString(10);
								this.el.sae_o_sel.value = this.oc_auto_exp.order_id.toString(2);
							}
						});
						
						// Slå på/av auto-exp (server)
						this.el.aec.addEventListener("change",()=>{
							this.setSAE(this.el.aec.checked, true);
						});
						
						// Skapa alternativ för min/max-ISO för auto-exp (server)
						LUMIX_CLIENT.ISOS.forEach((iso,iso_i)=>{
							if(iso>0){
								let iso_option=document.createElement("option");
								let iso_opt2=document.createElement("option");
								this.el.sae_in_sel.appendChild(iso_option);
								this.el.sae_ix_sel.appendChild(iso_opt2);
								iso_option.appendChild(document.createTextNode(iso.toString(10)));
								iso_option.setAttribute("value",iso_i.toString(10));
								iso_opt2.setAttribute("value",iso_i.toString(10));
								iso_opt2.appendChild(document.createTextNode(iso.toString(10)));
							}
						});
						// Skapa alternativ för min/max-slutartid för auto-exp (server)
						LUMIX_CLIENT.SHTR_SPEEDS_STR.forEach((shtr,shtr_i)=>{
							if(shtr_i > 0){
								let shtr_option=document.createElement("option");
								let shtr_opt2=document.createElement("option");
								this.el.sae_sn_sel.appendChild(shtr_option);
								this.el.sae_sx_sel.appendChild(shtr_opt2);
								shtr_option.appendChild(document.createTextNode(shtr.toString(10)+" s"));
								shtr_option.setAttribute("value",shtr_i.toString(10));
								shtr_opt2.setAttribute("value",shtr_i.toString(10));
								shtr_opt2.appendChild(document.createTextNode(shtr.toString(10)+" s"));
							}
						});
						// Skapa alternativ för min/max-aperture för auto-exp (server)
						LUMIX_CLIENT.APERTURES.forEach((aper,aper_i)=>{
							if(aper!==0){
								let ap_option=document.createElement("option");
								let aper_opt2=document.createElement("option");
								this.el.sae_an_sel.appendChild(ap_option);
								this.el.sae_ax_sel.appendChild(aper_opt2);
								ap_option.appendChild(document.createTextNode("f/"+aper.toString(10)));
								ap_option.setAttribute("value",aper_i.toString(10));
								aper_opt2.setAttribute("value",aper_i.toString(10));
								aper_opt2.appendChild(document.createTextNode("f/"+aper.toString(10)));
							}
						});
						
						// Välj max/min-ISO för auto-exp (server)
						this.el.sae_in_sel.addEventListener("change", () => {
							this.oc_auto_exp.iso_limit[0] = parseInt(this.el.sae_in_sel.value);
							this.sendOCAESettings();
						});
						this.el.sae_ix_sel.addEventListener("change", () => {
							this.oc_auto_exp.iso_limit[1] = parseInt(this.el.sae_ix_sel.value);
							this.sendOCAESettings();
						});
						// Välj max/min-aperture för auto-exp (server)
						this.el.sae_an_sel.addEventListener("change", () => {
							this.oc_auto_exp.aperture_limit[0] = parseInt(this.el.sae_an_sel.value);
							this.sendOCAESettings();
						});
						this.el.sae_ax_sel.addEventListener("change", () => {
							this.oc_auto_exp.aperture_limit[1] = parseInt(this.el.sae_ax_sel.value);
							this.sendOCAESettings();
						});
						// Välj max/min-shutter för auto-exp (server)
						this.el.sae_sn_sel.addEventListener("change", () => {
							this.oc_auto_exp.shtr_limit[0] = parseInt(this.el.sae_sn_sel.value);
							this.sendOCAESettings();
						});
						this.el.sae_sx_sel.addEventListener("change", () => {
							this.oc_auto_exp.shtr_limit[1] = parseInt(this.el.sae_sx_sel.value);
							this.sendOCAESettings();
						});
						// Välj ordning för auto-exp (server)
						this.el.sae_o_sel.addEventListener("change", () => {
							this.oc_auto_exp.order_id = parseInt(this.el.sae_o_sel.value, 2);
							this.sendOCAESettings();
						});
						this.el.lpu.addEventListener("click", () => {
							this.websocket.send(new Uint8Array([0b11]));
						});
						this.el.lpset.addEventListener("click", () => {
							let value=prompt("Ange bild-id (ex. '119-651')");
							if(value && value.length > 4){
								this.websocket.send("lpicid_"+value);
							}
						});
					});
					socket.addEventListener('message',(event)=>this.receiveMessage(event));
				}
				setISO(id,sync){
					return new Promise((resolve,reject) => {
						this.el.isoText.innerText = LUMIX_CLIENT.ISOS[id];
						this.el.isoInput.value = id;
						this.camera_settings.iso_id = id;

						if(sync) this.websocket.send(new Uint8Array([0b100, id]));
						resolve();
					});
				}

				setShutter(id, sync){
					return new Promise((resolve, reject) => {
						if(id < 0){
							id = parseInt(this.el.shutterSpeedInput.value);
						}else{
							this.el.shutterSpeedInput.value = id;
						}

						if(this.state.timed_shutter > 0){
							this.setTimedShutter(id, sync);
						}else{
							this.el.sl_sv.innerText = LUMIX_CLIENT.SHTR_SPEEDS_STR[id] + " s";
							this.camera_settings.shtr_id = id;
							if(sync) this.websocket.send(new Uint8Array([0b110, id])); // SETSHTR
						}
						resolve();
					});
				}

				setAperture(id, sync){
					return new Promise((resolve, reject) => {
						this.el.apertureText.innerHTML = "<i>f</i>/" + LUMIX_CLIENT.APERTURES[id];
						this.el.apertureInput.value = id;
						this.camera_settings.aperture_id = id;

						if(sync) this.websocket.send(new Uint8Array([0b101, id]));
						resolve();
					});
				}

				setWB(wb, sync){
					return new Promise((resolve, reject) => {
						this.el.wbText.innerHTML = wb + " K";
						this.el.wbInput.value = wb;
						this.camera_settings.wb = wb;
						if(sync) this.websocket.send(new Uint8Array([0b111, wb >>> 8, wb]));
						resolve();
					});
				}

				setPhotoMode(id, sync){
					let set_id = this.state.photo_mode;
					if(id == 0 && this.timelapse.remaining == 0) set_id = 0;
					if(id == 1) set_id = 1;
					if(id == 2 && this.timelapse.remaining == 0 && this.state.timed_shutter == 0 && !this.oc_auto_exp.enabled){
						set_id = 2;
					}

					this.el.spc.style.display = set_id == 0 ? "block" : "none";
					this.el.tlc.style.display = set_id == 1 ? "block" : "none";
					this.el.brc.style.display = set_id == 2 ? "block" : "none";
					this.el.spt.classList[set_id == 0 ? "add" : "remove"]("active");
					this.el.tlt.classList[set_id == 1 ? "add" : "remove"]("active");
					this.el.brt.classList[set_id == 2 ? "add" : "remove"]("active");
					this.state.photo_mode = set_id;

					if(sync) this.websocket.send(new Uint8Array([0b1100, set_id]));
				}

				takePhoto(){
					return new Promise(async(resolve,reject) => {
						this.websocket.send(new Uint8Array([0b1]));
						this.el.shutterReleaseBtn.style.background = "#ea6e00";
						if(this.state.timed_shutter){
							setTimeout(() => {
								this.el.shutterReleaseBtn.style.background = "#000000";
								resolve();
							}, this.state.timed_shutter_t * 1000);
						} else {
							setTimeout(() => {
								this.el.shutterReleaseBtn.style.background = "#000000";
								resolve();
							}, LUMIX_CLIENT.SHTR_SPEEDS[this.camera_settings.shtr_id] * 1000);
						}
					});
				}
				setSAE(enabled, sync){
					if(enabled){
						if(this.state.photo_mode!==2){
							this.el.saeb.classList.add("on");
							this.oc_auto_exp.enabled = true;
							if(sync) this.sendOCAESettings();
						}
					} else {
						this.el.saeb.classList.remove("on");
						this.oc_auto_exp.enabled = false;
						if(sync) this.sendOCAESettings();
					}
				}
				cancelCapture(){
					this.websocket.send(new Uint8Array([0b1000]));
				}
				setTimedShutter(seconds, sync){
					this.state.timed_shutter = seconds;
					this.el.tsh.checked = seconds > 0;
					this.el.sl_sv.innerText = seconds + " s";
					if(sync) this.websocket.send(new Uint8Array([0b1011, seconds])); // TSHSET

					if(seconds > 0){
						this.el.shutterSpeedInput.setAttribute("min", "5");
						this.el.shutterSpeedInput.setAttribute("max", "120");
						this.el.shutterSpeedInput.value = seconds;
					} else {
						this.el.shutterSpeedInput.setAttribute("min", "1");
						this.el.shutterSpeedInput.setAttribute("max", "52");
						this.setShutter(-1, sync);
					}
				}

				sendOCAESettings(){
					let mask = this.oc_auto_exp.enabled ? 0b11111111 : 0b00000000;
					this.websocket.send(new Uint8Array([
						0b1010,
						this.oc_auto_exp.iso_limit[0] & mask,
						this.oc_auto_exp.iso_limit[1] & mask,
						this.oc_auto_exp.aperture_limit[0] & mask,
						this.oc_auto_exp.aperture_limit[1] & mask,
						this.oc_auto_exp.shtr_limit[0] & mask,
						this.oc_auto_exp.shtr_limit[1] & mask,
						this.oc_auto_exp.order_id & 0b111 & mask
					]));
				}
				
				// Mycket viktiga funktioner. Är grunden till alla kommandon och synk-funktioner.
				receiveMessage(event){
					event.data.slice(0, 8).bytes().then(msg => {
						console.log("Meddelandetyp 0x" + msg[0].toString(16));
						// Meddelande från server
						switch(msg[0]){
							case 0b10000000: // STATE
								this.setISO(msg[1], false);
								this.setAperture(msg[2], false);
								this.setWB((msg[4] << 8) + msg[5], false);
								this.setTimedShutter(msg[6], false);
								if(msg[6] == 0){
									this.setShutter(msg[3], false);
								}
								this.setPhotoMode(msg[7], false);
								break;
							case 0b10000001: // TLSTAT
								let tlr = (msg[4] << 8) + msg[5]; // antal bilder kvar
								let tl = tlr > 0; // timelapse pågår
								this.timelapse.interval = msg[1];
								this.timelapse.total = (msg[2] << 8) + msg[3];
								this.timelapse.remaining = tlr;
								this.el.sl_it.disabled = tl;
								this.el.sl_im.disabled = tl;
								this.el.tsh.disabled = tl;
								this.el.tlr.style.display= tl ? "inline-block" : "none";
								this.el.startTimelapseBtn.innerText = tl ? "STOP" : "START";
								if(tl) this.updateTLTime();
								break;
							case 0b10000011: // NEWIMG
								console.log(event.data.slice(1)); // bilddata (binärt, jpeg troligen)
								// this.el.pci.src="data:"+msg[1];
								break;
							case 0b10000010: // OCAEST
								let enabled = msg[1] + msg[2] + msg[3] + msg[4] + msg[5] + msg[6] + msg[7] > 0;
								this.setSAE(enabled, false);
								if(enabled){
									this.oc_auto_exp.order_id = msg[7];
									this.oc_auto_exp.iso_limit = [msg[1], msg[2]];
									this.oc_auto_exp.shtr_limit = [msg[5], msg[6]];
									this.oc_auto_exp.aperture_limit = [msg[3], msg[4]];
								}
								break;
							default:
								console.error("Unknown websocket message from server.", msg);
						}
					});
				}
				updateTLTime(){
					let all_seconds = this.timelapse.interval * this.timelapse.remaining;
					let hours = Math.floor(all_seconds / 3600);
					let minutes = Math.floor((all_seconds - hours * 3600) / 60);
					let seconds = all_seconds - (hours * 3600 + minutes * 60);
					this.el.pr.innerText = this.timelapse.remaining;

					let tva=x=>("0" + x.toString()).slice(-2);

					if(hours > 0){
						this.el.tr.innerText = tva(hours) + "h " + tva(minutes) + "m";
					} else {
						this.el.tr.innerText = tva(minutes) + "m " + tva(seconds) + "s";
					}
				}
			}
			</script>
			<style>
			#fm{
				background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAwUExURUdwTBQWFV9hYDEyMnt8fG5vbyQlJZqbm0dISIuMi9jZ2MzMzKeop7i5ucHBwbGxsX0UUksAAAABdFJOUwBA5thmAAAA7ElEQVQ4y5VT2xKFIAgU8Zam/f/fHiVvpE1z9kEndwMWVIgKSavX89cMDUThvUmwDz4AQCgygEuIC8A8BDIzkmSFwrydXFAY8I42ZcvqGE9HIOGGoXXJ8ESaBW4jYD5wIzj+Enym2BUZVpsMuGnUewlCqI8Aiw/jO+PDRoGd97m+Y3Gihj1dsrfBHbL0A0d5l8l/lzti4uRGse7YGlmtgkhTjxRh3I8hqOc5cTN2zoJUTRm6oBV6CHQ7k6zLGG5BQjbSeZIln57bTr2Cd+i3WUMvcT/Khv54TrPlLXu7C1ziFyLmUSFFMuik6tF/VScFcv3y11wAAAAASUVORK5CYII=)}#fp{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAgCAMAAACxWgF2AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAwUExURUdwTAAAAAYGBg0NDRwcHKqqqpWVlYSEhHZ2dj8/P2ZmZlpaWikpKU1NTbm5uTQ0NE58BR8AAAABdFJOUwBA5thmAAAAsklEQVQ4y42TSQ7DIBAEaXa8/v+3UQwo2MzEXRcOLllopjBGI7rF8Fgg0PIOwLPygS+JtLfLdpwcUVkp2zUbjLx0GSdh40d8lctgq1MMuZ0Yyer2ynX6m21l+UTddcKdXbxHv6V92DgE27ddr08Z2yzn+sUFzEQpUBUnBaqzSIHqSIHqFClQnSAFquKlQHWSFOj7FAtj90cXwGGEQHWuR5fAEqnpDVNcwZP/tjf/PFsalz6uRQUfv0hNYAAAAABJRU5ErkJggg==)
				}
				#fm,#fp{
					background-size:contain;
					background-repeat:no-repeat;
					background-position:center;
					color:transparent
				}
				body{
					margin:0;
					padding:15px 8vw 0 8vw;
					text-align:center;
					background:#111;
					color:#e0e0e0
				}
				.slider{
					width:100%;
					text-align:center;
					margin:0 0 10px 0
				}
				#e2l,#e2r{
					display:inline-block;
					width:calc(50% - 4px)
				}
				#e2r,#fct,#tct,#saec{
					margin-left:8px
				}
				#a{
					text-align:center;
					width:calc(42vw - 2px);
					font-size:1em;
					display:inline-block;
					height:20px
				}
				#cbt{
					margin:0 calc(21vw - 45px);
					width:90px;
					display:inline-block;
					height:22px;
					border-radius:30px;
					vertical-align:top
				}
				#a,#brb,#ti,.slider,.z{
					padding:0
				}
				.slider{
					-webkit-appearance:none;
					background:0 0
				}
				.slider::-webkit-slider-thumb{
					-webkit-appearance:none;
					width:19px;
					height:19px;
					border-radius:50%;
					border:none;
					background-color:#f06a00;
					margin-top:-7px
				}
				.slider::-webkit-slider-runnable-track{
					background-color:#565656;
					height:5px;
					border-radius:2.5px
				}
				.mb{
					margin-bottom:9px
				}
				#brc,#spc,#tlc{
					height:107px
				}
				.z{
					width:38px
				}
				#a,#bh,#bl,#bm,#bs,#cbt,#lpset,#lpu,#pc,#ti,#tlr,.z{
					border:1px solid #9c9c9c
				}
				#lpset,#lpu,#ti,.z{
					border-radius:5px
				}
				#lpset,#lpu,#ti{
					height:19px
				}
				#brb{
					width:80px;
					height:80px;
					border-radius:50%;
					font-size:1em;
					border-width:2px;
					border-style:outset;
					border-color:#ddd #d8d8d8 #d8d8d8 #ddd
				}
				.z{
					height:24px;
					font-size:15px
				}
				#ti{
					width:56px;
					vertical-align:text-bottom;
					margin-bottom:3px
				}
				:not(#a,#j){
					-webkit-touch-callout:none;
					-webkit-user-select:none;
					touch-action:manipulation
				}
				#tlr{
					font-size:9px;
					line-height:1.1;
					display:none;
					vertical-align:bottom;
					text-align:left;
					margin:0 0 2px 3px;
					padding:1px;
					height:19px;
					width:75px
				}
				#pc{
					padding-bottom:calc(66.25% - 21.325px);
					width:calc(100% - 2px);
					height:20px;
				}
				#ltc{
					margin:2px 0 7px 0
				}
				#lpset{
					width:70px;
					vertical-align:bottom;
				}
				.sl,button{
					background-color:#e0e0e0
				}
				#pci{
					width:calc(84vw - 2px);
					height:auto;
					max-height:calc(55.65vw - 1.325px)
				}
				#pcn{
					background:#0006;
					padding:1px;
					position:absolute;
					right:calc(8vw + 1px);
					height:18px
				}
				body{
					position:fixed
				}
				ul{
					list-style-type:none;
					margin:0;
					padding:0;
					overflow:hidden;
					display:inline-block
				}
				li{
					float:left;
					border-radius:7px 7px 0 0;
					border-bottom:2px solid transparent;
					padding:0 5px 2px 5px
				}
				ul>li.active{
					border-bottom:2px solid #fff
				}
				#fct,#tct,#zct,#saec{
					display:inline-block;
					vertical-align:top;
				}
				#tct{
					vertical-align:bottom
				}
				#sbtn{
					height:67px;
					margin-top:13px;
					background:#222;
					border-radius:50%
				}
				#tabs{
					height:26px
				}
				#brs{
					display:inline-block;
					vertical-align:middle;
					margin-left:20px;
					width:108px;
				}
				#bh,#bl,#bm,#bs{
					border-radius:7px;
					background:#e0e0e0;
					padding:3px;
					width:40px;
					height:27px;
					margin:0 2px;
				}
				img.ba{
					background:#999!important;
				}
				#brcc{
					padding-top:8px;
				}
				.sw{
					position:relative;
					display:inline-block;
					width:44px;
					height:24px;
				}
				.sw input{
					width:0;
				}
				.sl{
					position:absolute;
					top:0;
					left:0;
					right:0;
					bottom:0;
					-webkit-transition:.4s;
					border-radius:34px
				}
				.sl:before{
					position:absolute;
					content:"";
					height:16px;
					width:16px;
					left:3px;
					bottom:3px;
					-webkit-transition:.4s;
					border-radius:50%;
					border:1px solid #444;
				}
				#tsh+.sl:before{
					background:url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAMAAAExAAIAAAARAAAATgAAAAAAAJOjAAAD6AAAk6MAAAPocGFpbnQubmV0IDQuMC4xNwAA/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAEAAQAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A/XD49/tQeLLz9r7w78C/h0dD03X9Q0CTxPrev6taSX0OjWQlaGJI7eOSPzJ5HSTG+RVUKDh84HUfAOw+NXhn4weJ9I+IGreG/FXgmKxtp9B12z0ldMvZLlmcTwTxLcyBgoCFXEcYO4jnFee/tWfsffEK6/a78J/Hz4Paj4UbxloWiS+GtY8PeJZp7TTfEWntI0qAXUEcslvPG7Ph/JkBDYIGM16v8BLv4xa/qV5qnxO0/wAAeF7SSAR2egeHNQudZeF8gmWa/mhtg/AwI0tlAySXbgUAf//Z);
				}
				input:checked+.sl{
					background-color:#39f
				}
				input:checked+.sl:before{
					-webkit-transform:translateX(20px);
				}
				#tsh:checked+.sl:before{
					background:url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAMAAAExAAIAAAARAAAATgAAAAAAAJOjAAAD6AAAk6MAAAPocGFpbnQubmV0IDQuMC4xNwAA/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAEAAQAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A/VH/AIKFfFT48fB3S/Hni74fXnhLS/A/w/8Ahzf+KpZNW0lr6XU9TtRcSm0UrNH5amGJPmIbBbp2qT9gD4lfHr4q23gfxR8RL7wjrHgnx18O7LxPHNpGkPYSabqdz9nlFo26aQyIIZHIbA5WvR/+CgXhbxD4/wD2Ifiv4a8KeHbzxV4i8VeFNS0Kw021ube3eaW7tpLdWL3Ekcaqpk3NlgdqnAJwDJ+wVoXiLwf+xj8MNA8V+Gr7wl4h8M+GdP0S+027uba4kiltbeOBmD28kkZVjGWXDE4IyAcigD//2Q==)
				}
				#aec+.sl:before{
					background:#fff;
				}
				#saeb{
					font-size:9pt;
				}
				#saeb.on{
					background-color:#39f;
					border:1px solid #1d6bb9;
				}
				#saed{
					position:fixed;
					top:45px;
					left:8vw;
					width:calc(84vw - 10px);
					height:130px;
					display:none;
					background-color:#111;
					border:1px solid #e0e0e0;
					text-align:left;
					padding:0 4px 0 4px;
				}
				#saed_l+.sw{
					vertical-align:middle;
				}
				select{
					-webkit-appearance:none;
					color:#00ffff;
					background:transparent;
					border:none;
					text-align:left;
					font-size:9.5pt;
				}
				#sae_sn_sel,#sae_sx_sel{
					width:62px;
				}
				#sae_in_sel,#sae_ix_sel{
					width:50px;
				}
				#sae_an_sel,#sae_ax_sel{
					width:40px;
				}
				#sae_o_sel{
					width:200px;
				}
				.sae_ti{
					font-weight:700;
				}
				#saed_l{
					width:100%;
					height:20px;
					text-align:center;
					font-weight:700;
					font-size:12pt;
				}
				#saet_c{
					width:calc(100% - 4px);
					padding:2px;
					height:25px;
					text-align:center;
				}
				</style>
			</head>
			<body onload="ready()">
				<div id="cnc" class="mb"><input id="a" type="text" value="192.168.54.1" disabled></input><button id="cbt" disabled>Ansluten</button></div><b>Slutartid:&nbsp;</b><span id="sl_sv">Laddar...</span><input type="range" min="1" max="52" value="1" class="slider" id="sl_s" disabled><div id="e2l"><b>Bländartal:&nbsp;</b><span id="sl_av">Laddar...</span><input type="range" min="0" max="9" value="1" class="slider" id="sl_a" disabled></div><div id="e2r"><b>ISO:&nbsp;</b><span id="sl_iv">Laddar...</span><input type="range" min="0" max="10" value="1" class="slider" id="sl_i" disabled></div><b>Vitbalans:&nbsp;</b><span id="sl_wv">Laddar...</span><input type="range" min="2500" max="10000" step="100" value="4000" class="slider mb" id="sl_w" disabled><div class="mb"><div id="zct"><b>Zoom</b><br><button class="z" id="zm" disabled><span class="ch">−</span></button>&nbsp;<button class="z" id="zp" disabled><span class="ch">+</span></button></div>&nbsp;<div id="fct"><b>Fokus</b><br><button class="z" id="fp" disabled>&nbsp;</button>&nbsp;<button class="z" id="fm" disabled>&nbsp;</button></div>&nbsp;<div id="tct"><b>C/T</b><br><label class="sw"><input type="checkbox" id="tsh" disabled><span class="sl"></span></label></div>&nbsp;<div id="saec"><b>S-AE</b><br><button class="z" id="saeb" disabled>&nbsp;</button></div></div><ul><li id="spt" class="active">Foto</li><li id="tlt">Timelapse</li><li id="brt">Burst</li></ul><div id="spc"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyOC4zIDI4LjMiIGZpbGw9IiNlMGUwZTAiPjxwYXRoIGQ9Ik04LjUgMy42M3MtMy41NiAxLjMyLTUuNjYgNi4zbDExLjU4LTIuMi01LjkyLTQuMXptLTUuODQgN3MtMS41NiAzLjQ2LjQ4IDguNDVsNi42Mi05Ljc2LTcuMSAxLjN6bS45MyA4Ljk0czEuMzIgMy41NiA2LjMgNS42NmwtMi4yLTExLjYtNC4xIDUuOTN6bTcgNS44M3MzLjQ2IDEuNTcgOC40NS0uNDhsLTkuNzYtNi42IDEuMyA3LjF6bTkuMTMtLjc3czMuNTYtMS4zMiA1LjY2LTYuM2wtMTEuNiAyLjIgNS45MyA0LjF6bTUuMzUtMTUuNDVsLTYuNiA5Ljc2IDcuMDgtMS4zMnMxLjU3LTMuNDUtLjQ4LTguNDR6bS0uNDQtLjVzLTEuMzItMy41NS02LjMtNS42NWwyLjIgMTEuNiA0LjEtNS45M3ptLTctNS44MnMtMy40Ni0xLjU3LTguNDUuNDhsOS43NiA2LjYtMS4zMi03LjA4ek0xNC4xNSAwYTE0LjE1IDE0LjE1IDAgMSAwIDAgMjguMyAxNC4xNSAxNC4xNSAwIDAgMCAwLTI4LjN6bTAgMjcuMmMtNy4yIDAtMTMuMDYtNS44NS0xMy4wNi0xMy4wNUExMy4xIDEzLjEgMCAwIDEgMTQuMTUgMS4wOWExMy4xIDEzLjEgMCAwIDEgMTMuMDYgMTMuMDYgMTMuMSAxMy4xIDAgMCAxLTEzLjA2IDEzLjA2eiIvPjwvc3ZnPg==" id="sbtn"></div><div id="tlc" style="display:none"><button id="ti" disabled>START</button><div id="tlr"><span id="pr">0</span>&nbsp;st återstår (<span id="tr">00:00</span>).</div><br><b>Intervall:</b>&nbsp;<span id="sl_itv">20 s</span><input type="range" min="5" max="120" value="20" class="slider" id="sl_it" disabled><b>Bilder:</b>&nbsp;<span id="sl_imv">150 st</span><input type="range" min="10" max="1000" value="150" step="10" class="slider" id="sl_im" disabled></div><div id="brc" style="display:none"><div id="brcc"><button id="brb" disabled>START</button><div id="brs"><div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAhCAMAAABHlLO1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAA5UExURUdwTAAAAAEBAdbW1gAAAAAAAAAAAAAAAAAAAAAAAP///+Hh4e3t7fb29jMzM7q6uqCgoIGBgWNjYxAk1U4AAAAKdFJOUwDf//9/PV7AliOQp6tKAAABJ0lEQVQ4y9WU3Y6EIAxGsaC0gOXn/R92izqZjRZn3Ls9F9Z84YSCoDHPQRiBAwPCCPh/xmXVR4hjQw0H08AqgBpe878aSQA1vOYfDTupRhRADSu4hwbO/dA5MotHkvQoYIWLIVmeCKvUhsSl9i/j9zI0mtsEeVnYFr+lRxkYTPJs3CzPmnGmZzIwe0JGzdCAYyCZrw1iaa3v79mI0UYNXqYcLWOfI5at1/gydCo67gWWmV9Z9rd/BnDINqUsC0oHm/E+R2cikIOaUnUsWue3sWpUZwjbaidet6Gwvg29tf0UyS1RDO0fkf2MszFTDMBhN8K90RYsjMghDQ0898QhlJpCwZFxhjj1uZLs7peGkb3NWS4icW1Lb2Ivt7Og93IFDblt5FGe8gPbNRsO1Wh3YQAAAABJRU5ErkJggg==" id="bs"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAhCAMAAABHlLO1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAnUExURUdwTAAAAAAAAAAAAAAAAP39/QAAANXV1d7e3unp6XR0dLCwsCwsLLna3A4AAAAFdFJOUwCAlii/0C90fwAAALVJREFUOMvVlIsKwyAMRWOyRmv9/++dL4bU3HbCKOwgUm57SBUN0TqsCAaGbgj9P2NadQ8ZG2YIyjxi7Bk1wzn/wrAWryGjZtgGkUhLpT3cG5xSLSQppaKoz0xGDdsg7e9d9NE9apy5NUygkXfFhxN+3KsyuUIMH8NmMGLl6MaO0H5Qhi+qgTvDYBwV34zLi1iPb5lehbgtGG2vBgP+GjQuCv3WYNBLsUG4Py0a3K+usLLQE7wByiQVDx9KxQQAAAAASUVORK5CYII=" id="bh"></div><div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAhCAMAAABHlLO1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABLUExURUdwTAAAAP///wAAAAAAAA8PDwAAAAAAAAAAAAAAAPHx8dPT09bW1tvb2+Hh4efn5/j4+Dg4OJSUlL29vVVVVX5+fm9vb6ioqMfHx1Mrp2wAAAAKdFJOUwCv//93+B/Bl0UyAi0aAAABg0lEQVQ4y9WU63KEIAyFlYDcRAyC6/s/aRNhurUrO+2fzvRMJjJHPg3XYfi9DPRkOgSInuD/ES+jbqbpE1ZLalttOY+ymp3fwEoCvWU5WNyQkPFRqklxSzgSgCtymFRMhjiXq0nxjtipLJOCmji9JyIJIDJhMWapQjLVZP9m8LCQABYmBnWkMS9oq1ljsnaqXVsDAgkgnIQpQaVNNbOGQlT23IGIPDEDzCSAeZfW0tjnnVrNrIHznLg0ejc/NBOeBOATfcEM+uG9mppZA70/FHWU2fv0lTgfbLN7JQ6PNIAxXYlvuhAPT8tLs7I1Yu7pcxyJ65/as83VrdpcYdiPwPWGHCqx9NTWA5c90RKNaVFLJWJPUAPjnmMxaj4gnkT/ZoC6tdDtym0aXQJ3Es/teKNKFH04VXhHb/pySG7ERwTXYtKat1XB+iS6pdExRFFkFkkcGsSTeHNHnIQSTtAZ+AWhNyGyfSHuSzNMyMK3xAtxL8sEJer8Q4J+bSZKdDGd6S/0AfomIsidPcJZAAAAAElFTkSuQmCC" id="bm"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAhCAMAAABHlLO1AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAA5UExURUdwTP///wAAANXV1QAAAAAAAAAAAAAAAAAAAAAAAPb29unp6dvb2+Hh4aSkpL29vSgoKEdHR39/f4tNzRoAAAAKdFJOUwD///8ec9q/lUmN4ca6AAABDUlEQVQ4y9WUjWqEMAyAe2m8tFabtO//sEutHnMaz4Mx2EewEPjSX+Pc5wSwCIYBDwv4f8Zh12sy2AaGgM5FGvSrQ08a08CoQKhV6xG3bywsS1LDNoiZ9G7yCKieh0sjKasRSyoDSqo9qXFh5KyGezI/h5rkZZxtHmZlM0Kd5cmZerKHcxhxZ0zKZqBMVaYy9GQPF0Ukfje8shhRS1HmyoA92UNzfil3MLQS4FB8O+FbRhskIrAXvGP85K1ximlMFttZUZ72xmyx3QfleW8kC1gfCuW0M+zO8DI4MZ0+4BOW50s8/oZhLq39hsSPo3HRI1YjNvC+4cuC4J2lhWas1OFeZ/7c0Ga0zYfuT/gCiKEV1q9GbZ4AAAAASUVORK5CYII=" id="bl"></div></div></div></div><div id="ltc"><b>Senaste fotot:&nbsp;</b><button id="lpu" disabled>Uppdatera</button>&nbsp;<button id="lpset" disabled>Ändra nr</button></div><div id="pc"><div id="pcn" style="display:none"></div><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMjUgMTI1Jz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojYWFhO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMH08L3N0eWxlPjxwYXRoIGQ9J000MS43IDMyLjJjMTYuOS0zLjUgMzQuOS03LjMgNTEuOC0xMC44LjggMy43IDEuNSA3LjEgMi4yIDEwLjhtLTc0LjYgNDVjLTIuOC0xMy41LTUuMy0yNS41LTguMS0zOSAyLjEtLjQgNi0xLjMgOC4xLTEuN200NS4xIDU4LjhjLTEzLjYgMi44LTI2IDUuNC0zOS42IDguMi0uNi0yLjktMS4xLTUuMy0xLjctOC4ybTc2LjYtMzUuOGMxLjcgOC4xIDMuOSAxOS4yIDUuNiAyNy4zLTIgLjQtMy43LjgtNS43IDEuMm0tODAuMyA3LjNoODAuNFYzMi4ybS01LjcgMEgyMS4xdjU3LjMnIGNsYXNzPSdhJy8+PHBhdGggZD0nTTM0LjQgNzkuNmM0LjQtMTEuOSA3LjgtMjAuOSAxMi4zLTMyLjggMy45IDQuOSA3LjUgOS4zIDExLjMgMTQuMk02MC42IDY0LjFjMS44IDIuMyAzLjcgNC42IDUuNiA2LjkgMy4yLTIuNCA2LjQtNC44IDkuNy03LjMgNC44IDcuMyA5LjcgMTQuNSAxNC41IDIxLjhIMzNNODcuNCA0My4zYzEuOCAxLjMgMy4xIDMuNSAzIDUuOSAwIDQtMy4zIDcuMi03LjMgNy4yLTMgMC01LjYtMS44LTYuNy00LjRNNzYgNDhjLjUtMy41IDMuNS02LjEgNy4yLTYuMS4zIDAgLjYgMCAuOS4xTTExNSAyMS41bC0xMDUgODInIGNsYXNzPSdhJy8+PC9zdmc+" id="pci"></div><div id="saed"><div id="saed_l">Auto-exponering (server)</div><div id="saet_c"><label class="sw"><input type="checkbox" id="aec" disabled><span class="sl"></span></label></div><div id="sae_i"><span class="sae_ti">ISO</span>&nbsp;Min.&nbsp;<select id="sae_in_sel"></select>&nbsp;Max.&nbsp;<select id="sae_ix_sel"></select></div><div id="sae_s"><span class="sae_ti">Slutartid</span>&nbsp;Min.&nbsp;<select id="sae_sn_sel"></select>&nbsp;Max.&nbsp;<select id="sae_sx_sel"></select></div><div id="sae_a"><span class="sae_ti">Bländartal</span>&nbsp;Min.&nbsp;<select id="sae_an_sel"></select>&nbsp;Max.&nbsp;<select id="sae_ax_sel"></select></div><div id="sae_o"><span class="sae_ti">Ordning</span><select id="sae_o_sel"><option value="001" selected>Slutartid > Bländartal > ISO</option><option value="000">Slutartid > ISO > Bländartal</option><option value="101">ISO > Slutartid > Bländartal</option><option value="100">ISO > Bländartal > Slutartid</option><option value="010">Bländartal > Slutartid > ISO</option><option value="011">Bländartal > ISO > Slutartid</option></select></div>

		<script>
		let camera;
		function act(){ // Aktivera alla inputs.
			document.querySelectorAll("button:not(#cbt),input:not(#a):not(#cbt)").forEach(e=>e.disabled=0);
		}

		ready=(()=>{
			camera=new LUMIX_CLIENT();
			act();
		});
		</script>
	</body>
</html>
